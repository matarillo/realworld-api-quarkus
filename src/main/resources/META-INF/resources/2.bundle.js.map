{"version":3,"sources":["webpack:///./app/pages/article-preview.comp.js"],"names":["markdown","require","ArticlePreviewComponent","params","slug","article","$articleBody","onCommentPost","bind","name","oldValue","newValue","this","innerHTML","render","document","getElementById","$commentCreate","querySelector","$commentsContainer","addEventListener","$articlePreviewBanner","Http","instance","doGet","then","response","json","r","updateArticlePreviewBanner","updateArticleContent","removeEventListener","e","detail","length","comment","doPost","JSON","stringify","comments","unshift","refresh","_slug","setAttribute","title","author","username","favoritesCount","createdAt","image","following","favorited","toHTML","body","HTMLElement","window","customElements","define"],"mappings":"4zDACA,IAAIA,EAAWC,EAAQ,IAAYD,SAE7BE,E,uZACF,WAAYC,GAAQ,a,4FAAA,UAChB,gBACKC,KAAOD,EAAOC,KACnB,EAAKC,QAAU,KAEf,EAAKC,aAAe,KACpB,EAAKC,cAAgB,EAAKA,cAAcC,KAAnB,MANL,E,uDAUhB,MAAO,O,kDAGcC,EAAMC,EAAUC,M,0CAIrB,WAChBC,KAAKC,UAAYD,KAAKE,SAEtBF,KAAKN,aAAeS,SAASC,eAAe,gBAC5CJ,KAAKK,eAAiBL,KAAKM,cAAc,kBACzCN,KAAKO,mBAAqBP,KAAKM,cAAc,sBAC7CN,KAAKK,eAAeG,iBAAiB,UAAWR,KAAKL,eACrDK,KAAKS,sBAAwBT,KAAKM,cAAc,0BAEhDI,IAAKC,SAASC,MAAM,aAAeZ,KAAKR,MAAM,GAAMqB,MAAK,SAACC,GACtD,OAAOA,EAASC,UACjBF,MAAK,SAAAG,GACJ,EAAKvB,QAAUuB,EAAEvB,QACjB,EAAKwB,6BACL,EAAKC,4B,6CAKTlB,KAAKK,eAAec,oBAAoB,UAAWnB,KAAKL,iB,oCAG9CyB,GAAG,WACb,GAAIA,EAAEC,QAAUD,EAAEC,OAAOC,OAAS,EAAG,CACjC,IAAMC,EAAU,CACZ,QAAW,CACP,KAAQH,EAAEC,SAGlBX,IAAKC,SAASa,OAAO,aAAexB,KAAKR,KAAO,YAAaiC,KAAKC,UAAUH,IAAU,GAAMV,MAAK,SAAAC,GAC7F,EAAKP,mBAAmBoB,SAASC,QAAQd,EAASS,SAClD,EAAKhB,mBAAmBsB,gB,mDAMhC7B,KAAKS,sBAAsBqB,MAAQ9B,KAAKP,QAAQD,KAChDQ,KAAKS,sBAAsBsB,aAAa,QAAS/B,KAAKP,QAAQuC,OAC9DhC,KAAKS,sBAAsBsB,aAAa,WAAY/B,KAAKP,QAAQwC,OAAOC,UACxElC,KAAKS,sBAAsBsB,aAAa,kBAAmB/B,KAAKP,QAAQ0C,gBACxEnC,KAAKS,sBAAsBsB,aAAa,OAAQ/B,KAAKP,QAAQ2C,WAC7DpC,KAAKS,sBAAsBsB,aAAa,QAAS/B,KAAKP,QAAQwC,OAAOI,OACrErC,KAAKS,sBAAsBsB,aAAa,YAAa/B,KAAKP,QAAQwC,OAAOK,WACzEtC,KAAKS,sBAAsBsB,aAAa,YAAa/B,KAAKP,QAAQ8C,a,6CAIlEvC,KAAKN,aAAaO,UAAYb,EAASoD,OAAOxC,KAAKP,QAAQgD,Q,+BAK3D,62BAkB4CzC,KAAKR,KAlBjD,4M,gCAvE8BkD,cAuGtCC,OAAOC,eAAeC,OAAO,kBAAmBvD,GACjCA","file":"2.bundle.js","sourcesContent":["import {Http} from \"../http/http\";\nvar markdown = require(\"markdown\").markdown;\n\nclass ArticlePreviewComponent extends HTMLElement {\n    constructor(params) {\n        super();\n        this.slug = params.slug;\n        this.article = null;\n\n        this.$articleBody = null;\n        this.onCommentPost = this.onCommentPost.bind(this);\n    }\n\n    static get observedAttributes() {\n        return [];\n    }\n\n    attributeChangedCallback(name, oldValue, newValue) {\n\n    }\n\n    connectedCallback() {\n        this.innerHTML = this.render();\n\n        this.$articleBody = document.getElementById('article-body');\n        this.$commentCreate = this.querySelector('comment-create');\n        this.$commentsContainer = this.querySelector('comments-container');\n        this.$commentCreate.addEventListener('comment', this.onCommentPost);\n        this.$articlePreviewBanner = this.querySelector('article-preview-banner');\n\n        Http.instance.doGet('/articles/' + this.slug, true).then((response) => {\n            return response.json();\n        }).then(r => {\n            this.article = r.article;\n            this.updateArticlePreviewBanner();\n            this.updateArticleContent();\n        });\n    }\n\n    disconnectedCallback() {\n        this.$commentCreate.removeEventListener('comment', this.onCommentPost);\n    }\n\n    onCommentPost(e) {\n        if (e.detail && e.detail.length > 0) {\n            const comment = {\n                \"comment\": {\n                    \"body\": e.detail\n                }\n            };\n            Http.instance.doPost('/articles/' + this.slug + '/comments', JSON.stringify(comment), true).then(response => {\n                this.$commentsContainer.comments.unshift(response.comment);\n                this.$commentsContainer.refresh();\n            });\n        }\n    }\n\n    updateArticlePreviewBanner() {\n        this.$articlePreviewBanner._slug = this.article.slug;\n        this.$articlePreviewBanner.setAttribute('title', this.article.title);\n        this.$articlePreviewBanner.setAttribute('username', this.article.author.username);\n        this.$articlePreviewBanner.setAttribute('favorites-count', this.article.favoritesCount);\n        this.$articlePreviewBanner.setAttribute('date', this.article.createdAt);\n        this.$articlePreviewBanner.setAttribute('image', this.article.author.image);\n        this.$articlePreviewBanner.setAttribute('following', this.article.author.following);\n        this.$articlePreviewBanner.setAttribute('favorited', this.article.favorited);\n    }\n\n    updateArticleContent() {\n        this.$articleBody.innerHTML = markdown.toHTML(this.article.body);\n    }\n\n\n    render() {\n        return `\n              <div class=\"article-page\">\n                <article-preview-banner following=\"\" title=\"Loading ..\" username=\"..\" date=\"..\" image=\"https://static.productionready.io/images/smiley-cyrus.jpg\" favorites-count=\"Loading ...\" ></article-preview-banner>\n                \n                  <div class=\"container page\">\n                \n                    <div class=\"row article-content\">\n                      <div id=\"article-body\" class=\"col-md-12\">\n                        Loading ...\n                      </div>\n                    </div>\n                \n                    <hr />\n                \n                    <div class=\"row\">\n                \n                      <div class=\"col-xs-12 col-md-8 offset-md-2\">\n                        <comment-create></comment-create>\n                        <comments-container slug=\"${this.slug}\"></comments-container>\n                      </div>\n                \n                    </div>\n                \n                  </div>\n                \n                </div>\n        `;\n    }\n\n\n}\n\nwindow.customElements.define('article-preview', ArticlePreviewComponent);\nexport default ArticlePreviewComponent;\n"],"sourceRoot":""}